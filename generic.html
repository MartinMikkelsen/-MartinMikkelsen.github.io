<!DOCTYPE HTML>
<html>
	<head>
		<title>Generic Page</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" href="assets/css/main.css" />
		<noscript><link rel="stylesheet" href="assets/css/noscript.css" /></noscript>
	</head>
	<body class="is-preload">

		<!-- Wrapper -->
			<div id="wrapper">

				<!-- Header -->
					<header id="header">
						<a href="index.html" class="logo">Home</a>
					</header>

					<nav id="nav">
						<ul class="links">
							<li class="active"><a href="index.html">Posts</a></li>
							<li><a href="generic.html">Generic Page</a></li>
							<li><a href="elements.html">Elements Reference</a></li>
						</ul>
						<ul class="icons">
							<li><a href="https://scicomp.stackexchange.com/users/42830/mmikkelsen" class="icon brands fa-stack-exchange"><span class="label">stackexchange</span></a></li>
							<li><a href="https://www.linkedin.com/in/martinmikkelsen1/" class="icon brands fa-linkedin"><span class="label">Linkedin</span></a></li>
							<li><a href="https://github.com/MartinMikkelsen" class="icon brands fa-github"><span class="label">GitHub</span></a></li>
						</ul>
					</nav>

				<!-- Main -->
					<div id="main">

						<!-- Post -->
							<section class="post">
								<header class="major">
									<span class="date">November 2022</span>
									<h1>Coulomb Wave functions in Python</h1>
									<p>Short gist to implement Coulomb wave functions in Python.</p>
								</header>
								<div class="image main"><img src="images/coulomb.png" alt="" /></div>
								<p>
									<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
									<script id="MathJax-script" async
											src="https://cdn.jsdelivr.net/npm/mathjax@3.0.1/es5/tex-mml-chtml.js">
									</script>
									The Coulomb wave equation for a charged particle with arbitrary angular momentum and charge is given by
										\[\nabla^2\psi +\left( k^2-\frac{2\mu}{\hbar^2}V(r)\right)\psi = 0,\]
									where \(\mu\) is the reduced mass of the system. The radial wave function \(u(r)\) satisfies the following differential equation
									\[
										\frac{\text{d}^2 u_\ell}{\text{d}r^2}+\left( k^2-\frac{\ell(\ell+1)}{r^2}-\frac{2\mu}{\hbar^2}\frac{Ze^2}{r}\right)u_\ell=0,
									\]
									where \(Z\) is the product of the charges. Two independent solutions can be found to this equation -- these are called the regular and irregular Coulomb wave functions denoted \(F_\ell(r)\) and \(G_\ell(r)\) respectively. The regular Coulomb wave function \(F_\ell(r)\) is a real function that vanishes at \(r=0\) and the behaviour of the function is described using a parameter \(\eta \) which describes how strongly the Coulomb interaction is
									\[
										\eta = \frac{Zmc\alpha }{\hbar k},
									\]
									where \(m\) is the mass of the particle, \(k\) is the wave number and \(\alpha\) is the fine structure constant. The solution to is given by
									\[
										F_\ell(\eta,kr) = C_\ell (\eta) (kr)^{\ell+1}\text{e}^{-ikr}  {}_1 F_1(\ell+1-i\eta,2\ell+2,2ikr),
									\]
									where \({}_1F_1(kr)\) is a confluent hypergeometric function and \(C_\ell(\eta)\) is a normalization constant given by 
									\[
										C_\ell(\eta) = \frac{2^\ell \text{e}^{-\pi\eta/2}|\Gamma(\ell+1+i\eta)|}{(2\ell+1)!},
									\]
									where \(\Gamma\) is the gamma function. For numerical purposes, it is useful to use the <a href="https://dlmf.nist.gov/33.7">integral representation of the regular Coulomb wave function</a>
									\[
										F_\ell(\eta,\rho) = \frac{\rho^{\ell+1}2^\ell e^{i\rho-(\pi\eta/2)}}{|\Gamma(\ell+1+i\eta)|} \int_0^1 e^{-2i\rho t}t^{\ell+i\eta}(1-t)^{\ell-i\eta} \, \text{d}t.
									\]</p>
							
								<h2>Python code</h2>
								<pre><code>
def complex_quadrature(func, a, b, **kwargs):
	def real_func(x):
		return np.real(func(x))
	def imag_func(x):
		return np.imag(func(x))
	real_integral = quad(real_func, a, b, **kwargs)
	imag_integral = quad(imag_func, a, b, **kwargs)
	return (real_integral[0] + 1j*imag_integral[0], real_integral[1:], imag_integral[1:])

def RegularCoulomb(l,eta,rho):
	First = rho**(l+1)*2**l*np.exp(1j*rho-(np.pi*eta/2),dtype='complex_')/(abs(gamma(l+1+1j*eta)))
	integral = complex_quadrature(lambda t: np.exp(-2*1j*rho*t,dtype='complex_')*t**(l+1j*eta)*(1-t)**(l-1j*eta),0,1)[0]
	return np.array(First*integral,dtype='complex_')

def C(l,eta):
	return 2**l*np.exp(-np.pi*eta/2)*(abs(gamma(l+1+1j*eta))/(factorial(2*l+1)))

def IrregularCoulomb(l,eta,rho):
	First = np.exp(-1j*rho)*rho**(-l)/(factorial(2*l+1)*C(l,eta))
	integral = quad(lambda t: np.exp(-t)*t**(-l-1j*eta)*(t+2*1j*rho)**(l+1j*eta),0,np.infty)[0]
	return First*integral
						</code></pre>
						<h2>Julia code with example</h2>
								<pre><code>
using QuadGK, SpecialFunctions, Plots

function complex_quadrature(func,a,b)
	function real_func(x)
		return real(func(x))
	end
	function imag_func(x)
		imag(func(x))
	end
	real_integral = quadgk(real_func,a,b)
	imag_integral = quadgk(imag_func,a,b)
	return real_integral[1] + 1im*imag_integral[1]
end

function regular_coulomb(ℓ,η,ρ)
	First = ρ^(ℓ+1)*2^ℓ*exp(1im*ρ-(π*η/2))/(abs(gamma(ℓ+1+1im*η)))
	Integral_value = complex_quadrature(t -> exp(-2*1im.*ρ*t)*t^(ℓ+1im*η)*(1-t)^(ℓ-1im*η),0,1)
	return First.*Integral_value
end

function C(ℓ,η)
	return 2^ℓ*exp(-π*η/2)*(abs(gamma(ℓ+1+1im*η))/(factorial(2*ℓ+1)))
end

function irregular_coulomb(ℓ,η,ρ)
	First = exp(-1im*ρ)*ρ^(-ℓ)/(factorial(2*ℓ+1)*C(ℓ,η))
	Integral_value = complex_quadrature(t -> exp(-t)*t^(-ℓ-1im*η)*(t+2*1im*ρ)^(ℓ+1im*η),0.01,1e4)
	return First.*Integral_value
end


xes = range(0,10,100)
coulombwave1 = real([regular_coulomb(1,-2,i) for i in xes])
coulombwave2 = real([regular_coulomb(2,-10,i) for i in xes])


plot!(xes,coulombwave1, linewidth=2.5, label="Regular Coulomb wave(1,-2,ρ)")
plot!(xes,coulombwave2, linewidth=2.5, label="Regular Coulomb wave(2,-10,ρ)")
						</code></pre>
							</section>

					</div>


		<!-- Scripts -->
			<script src="assets/js/jquery.min.js"></script>
			<script src="assets/js/jquery.scrollex.min.js"></script>
			<script src="assets/js/jquery.scrolly.min.js"></script>
			<script src="assets/js/browser.min.js"></script>
			<script src="assets/js/breakpoints.min.js"></script>
			<script src="assets/js/util.js"></script>
			<script src="assets/js/main.js"></script>
			<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
			<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3.0.1/es5/tex-mml-chtml.js"></script>
	</body>
</html>