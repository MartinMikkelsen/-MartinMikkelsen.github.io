<!doctype html> <html lang=en > <meta charset=UTF-8 > <meta name=viewport  content="width=device-width, initial-scale=1"> <link rel=stylesheet  href="/martinmikkelsen.github.io/pages/libs/katex/katex.min.css"> <link rel=stylesheet  href="/martinmikkelsen.github.io/pages/libs/highlight/styles/github.min.css"> <link rel=stylesheet  href="/martinmikkelsen.github.io/pages/css/franklin.css"> <link rel=stylesheet  href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,700,400italic|Source+Code+Pro:400,700" type="text/css"> <link rel=stylesheet  href="/martinmikkelsen.github.io/pages/css/font-awesome.min.css"> <link rel=stylesheet  href="/martinmikkelsen.github.io/pages/css/celeste.min.css"> <link rel=icon  type="image/png" sizes=192x192  href="/martinmikkelsen.github.io/pages/assets/favicon.png"> <link rel="shortcut icon" href="/martinmikkelsen.github.io/pages/assets/favicon.ico"> <link rel=apple-touch-icon-precomposed  sizes=152x152  href="/martinmikkelsen.github.io/pages/assets/apple-touch-icon.png"> <title>Code</title> <header> <nav class=nav-main > <ul> <li class=hvr-underline-reveal ><a href="/martinmikkelsen.github.io/pages/">Home</a> <li class=hvr-underline-reveal ><a href="/martinmikkelsen.github.io/pages/menu1/">Code</a> <li class=logo ><a class=hvr-ripple-out  href="/martinmikkelsen.github.io/pages/">M</a> <li class=hvr-underline-reveal ><a href="/martinmikkelsen.github.io/pages/menu2/">About</a> </ul> </nav> </header> <div class=franklin-content > <div class=franklin-toc ><ol><li><a href="#coulomb_wave_funcitons">Coulomb Wave Funcitons</a><ol><li><a href="#examples">Examples</a></ol><li><a href="#solving_non-linear_partial_differential_equation_numerically_u_xxu_yymathrmeu">Solving non-linear partial differential equation numerically <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>u</mi><mrow><mi>x</mi><mi>x</mi></mrow></msub><mo>+</mo><msub><mi>u</mi><mrow><mi>y</mi><mi>y</mi></mrow></msub><mo>=</mo><msup><mi mathvariant=normal >e</mi><mi>u</mi></msup></mrow><annotation encoding="application/x-tex">u_{xx}+u_{yy}=\mathrm{e}^{u}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.7333em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal">u</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">xx</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222em;"></span></span><span class=base ><span class=strut  style="height:0.7167em;vertical-align:-0.2861em;"></span><span class=mord ><span class="mord mathnormal">u</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">yy</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.2861em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2778em;"></span></span><span class=base ><span class=strut  style="height:0.6644em;"></span><span class=mord ><span class="mord mathrm">e</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">u</span></span></span></span></span></span></span></span></span></span></span></span></a><ol><li><a href="#solution">Solution </a></ol><li><a href="#optimal_quadrature_rule_for_heavy_tail_measure">Optimal quadrature rule for heavy tail measure</a><ol><li><a href="#solution__2">Solution </a></ol></ol></div> <h2 id=coulomb_wave_funcitons ><a href="#coulomb_wave_funcitons" class=header-anchor >Coulomb Wave Funcitons</a></h2> <p>As a part of my master&#39;s thesis I had to make a numerical implementation of the Coulomb wave functions. The Coulomb wave equation for a charged particle with arbitrary angular momentum and charge is given by </p> <span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><msup><mi mathvariant=normal >∇</mi><mn>2</mn></msup><mi>ψ</mi><mo>+</mo><mrow><mo fence=true >(</mo><msup><mi>k</mi><mn>2</mn></msup><mo>−</mo><mfrac><mrow><mn>2</mn><mi>μ</mi></mrow><msup><mi mathvariant=normal >ℏ</mi><mn>2</mn></msup></mfrac><mi>V</mi><mo stretchy=false >(</mo><mi>r</mi><mo stretchy=false >)</mo><mo fence=true >)</mo></mrow><mi>ψ</mi><mo>=</mo><mn>0</mn><mo separator=true >,</mo></mrow><annotation encoding="application/x-tex"> \nabla^2\psi +\left( k^2-\frac{2\mu}{\hbar^2}V(r)\right)\psi = 0, </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.0585em;vertical-align:-0.1944em;"></span><span class=mord ><span class=mord >∇</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.03588em;">ψ</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222em;"></span></span><span class=base ><span class=strut  style="height:2.4em;vertical-align:-0.95em;"></span><span class=minner ><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">(</span></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.3214em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord ><span class=mord >ℏ</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.7401em;"><span style="top:-2.989em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >2</span><span class="mord mathnormal">μ</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class=mclose >)</span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">)</span></span></span><span class=mspace  style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">ψ</span><span class=mspace  style="margin-right:0.2778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2778em;"></span></span><span class=base ><span class=strut  style="height:0.8389em;vertical-align:-0.1944em;"></span><span class=mord >0</span><span class=mpunct >,</span></span></span></span></span> <p>where <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>μ</mi></mrow><annotation encoding="application/x-tex">\mu</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">μ</span></span></span></span> is the reduced mass of the system. The radial wave function <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi><mo stretchy=false >(</mo><mi>r</mi><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">u(r)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">u</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class=mclose >)</span></span></span></span> satisfies the following differential equation</p> <span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><mfrac><mrow><msup><mtext>d</mtext><mn>2</mn></msup><msub><mi>u</mi><mi mathvariant=normal >ℓ</mi></msub></mrow><mrow><mtext>d</mtext><msup><mi>r</mi><mn>2</mn></msup></mrow></mfrac><mo>+</mo><mrow><mo fence=true >(</mo><msup><mi>k</mi><mn>2</mn></msup><mo>−</mo><mfrac><mrow><mi mathvariant=normal >ℓ</mi><mo stretchy=false >(</mo><mi mathvariant=normal >ℓ</mi><mo>+</mo><mn>1</mn><mo stretchy=false >)</mo></mrow><msup><mi>r</mi><mn>2</mn></msup></mfrac><mo>−</mo><mfrac><mrow><mn>2</mn><mi>μ</mi></mrow><msup><mi mathvariant=normal >ℏ</mi><mn>2</mn></msup></mfrac><mfrac><mrow><mi>Z</mi><msup><mi>e</mi><mn>2</mn></msup></mrow><mi>r</mi></mfrac><mo fence=true >)</mo></mrow><msub><mi>u</mi><mi mathvariant=normal >ℓ</mi></msub><mo>=</mo><mn>0</mn><mo separator=true >,</mo></mrow><annotation encoding="application/x-tex"> \frac{\text{d}^2 u_\ell}{\text{d}r^2}+\left( k^2-\frac{\ell(\ell+1)}{r^2}-\frac{2\mu}{\hbar^2}\frac{Ze^2}{r}\right)u_\ell=0, </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:2.2614em;vertical-align:-0.686em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.5754em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord text"><span class=mord >d</span></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.7401em;"><span style="top:-2.989em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord ><span class="mord text"><span class=mord >d</span></span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8984em;"><span style="top:-3.1473em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class=mord ><span class="mord mathnormal">u</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">ℓ</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222em;"></span></span><span class=base ><span class=strut  style="height:2.4411em;vertical-align:-0.95em;"></span><span class=minner ><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">(</span></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.427em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord ><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.7401em;"><span style="top:-2.989em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >ℓ</span><span class=mopen >(</span><span class=mord >ℓ</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mord >1</span><span class=mclose >)</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.3214em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord ><span class=mord >ℏ</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.7401em;"><span style="top:-2.989em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >2</span><span class="mord mathnormal">μ</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.4911em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class=mord ><span class="mord mathnormal">e</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">)</span></span></span><span class=mspace  style="margin-right:0.1667em;"></span><span class=mord ><span class="mord mathnormal">u</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">ℓ</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2778em;"></span></span><span class=base ><span class=strut  style="height:0.8389em;vertical-align:-0.1944em;"></span><span class=mord >0</span><span class=mpunct >,</span></span></span></span></span> <p>where <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Z</mi></mrow><annotation encoding="application/x-tex">Z</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span></span></span></span> is the product of the charges. Two independent solutions can be found to this equation – these are called the regular and irregular Coulomb wave functions denoted <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mi mathvariant=normal >ℓ</mi></msub><mo stretchy=false >(</mo><mi>r</mi><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">F_\ell(r)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">ℓ</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class=mclose >)</span></span></span></span> and <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>G</mi><mi mathvariant=normal >ℓ</mi></msub><mo stretchy=false >(</mo><mi>r</mi><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">G_\ell(r)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord ><span class="mord mathnormal">G</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">ℓ</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class=mclose >)</span></span></span></span> respectively. The regular Coulomb wave function <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mi mathvariant=normal >ℓ</mi></msub><mo stretchy=false >(</mo><mi>r</mi><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">F_\ell(r)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">ℓ</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class=mclose >)</span></span></span></span> is a real function that vanishes at <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">r=0</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class=mspace  style="margin-right:0.2778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2778em;"></span></span><span class=base ><span class=strut  style="height:0.6444em;"></span><span class=mord >0</span></span></span></span> and the behaviour of the function is described using a parameter <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>η</mi></mrow><annotation encoding="application/x-tex">\eta</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">η</span></span></span></span> which describes how strongly the Coulomb interaction is</p> <span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><mi>η</mi><mo>=</mo><mfrac><mrow><mi>Z</mi><mi>m</mi><mi>c</mi><mi>α</mi></mrow><mrow><mi mathvariant=normal >ℏ</mi><mi>k</mi></mrow></mfrac><mo separator=true >,</mo></mrow><annotation encoding="application/x-tex"> \eta = \frac{Zmc\alpha }{\hbar k}, </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">η</span><span class=mspace  style="margin-right:0.2778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2778em;"></span></span><span class=base ><span class=strut  style="height:2.0463em;vertical-align:-0.686em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.3603em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >ℏ</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="mord mathnormal">m</span><span class="mord mathnormal">c</span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mpunct >,</span></span></span></span></span> <p>where <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span> is the mass of the particle, <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> is the wave number and <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi></mrow><annotation encoding="application/x-tex">\alpha</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span></span></span> is the fine structure constant. The solution to is given by</p> <span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><msub><mi>F</mi><mi mathvariant=normal >ℓ</mi></msub><mo stretchy=false >(</mo><mi>η</mi><mo separator=true >,</mo><mi>k</mi><mi>r</mi><mo stretchy=false >)</mo><mo>=</mo><msub><mi>C</mi><mi mathvariant=normal >ℓ</mi></msub><mo stretchy=false >(</mo><mi>η</mi><mo stretchy=false >)</mo><mo stretchy=false >(</mo><mi>k</mi><mi>r</mi><msup><mo stretchy=false >)</mo><mrow><mi mathvariant=normal >ℓ</mi><mo>+</mo><mn>1</mn></mrow></msup><msup><mtext>e</mtext><mrow><mo>−</mo><mi>i</mi><mi>k</mi><mi>r</mi></mrow></msup><msub><mrow></mrow><mn>1</mn></msub><msub><mi>F</mi><mn>1</mn></msub><mo stretchy=false >(</mo><mi mathvariant=normal >ℓ</mi><mo>+</mo><mn>1</mn><mo>−</mo><mi>i</mi><mi>η</mi><mo separator=true >,</mo><mn>2</mn><mi mathvariant=normal >ℓ</mi><mo>+</mo><mn>2</mn><mo separator=true >,</mo><mn>2</mn><mi>i</mi><mi>k</mi><mi>r</mi><mo stretchy=false >)</mo><mo separator=true >,</mo></mrow><annotation encoding="application/x-tex"> F_\ell(\eta,kr) = C_\ell (\eta) (kr)^{\ell+1}\text{e}^{-ikr} {}_1 F_1(\ell+1-i\eta,2\ell+2,2ikr), </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">ℓ</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.03588em;">η</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2778em;"></span></span><span class=base ><span class=strut  style="height:1.1491em;vertical-align:-0.25em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">ℓ</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.03588em;">η</span><span class=mclose >)</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class=mclose ><span class=mclose >)</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8991em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">ℓ</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class=mord ><span class="mord text"><span class=mord >e</span></span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8991em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">ik</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span></span></span></span></span></span><span class=mord ><span class=mord ></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3011em;"><span style="top:-2.55em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mopen >(</span><span class=mord >ℓ</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222em;"></span></span><span class=base ><span class=strut  style="height:0.7278em;vertical-align:-0.0833em;"></span><span class=mord >1</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222em;"></span></span><span class=base ><span class=strut  style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right:0.03588em;">η</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.1667em;"></span><span class=mord >2</span><span class=mord >ℓ</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord >2</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.1667em;"></span><span class=mord >2</span><span class="mord mathnormal" style="margin-right:0.03148em;">ik</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class=mclose >)</span><span class=mpunct >,</span></span></span></span></span> <p>where <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mrow></mrow><mn>1</mn></msub><msub><mi>F</mi><mn>1</mn></msub><mo stretchy=false >(</mo><mi>k</mi><mi>r</mi><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">{}_1F_1(kr)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord ><span class=mord ></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3011em;"><span style="top:-2.55em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class=mclose >)</span></span></span></span> is a confluent hypergeometric function and <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mi mathvariant=normal >ℓ</mi></msub><mo stretchy=false >(</mo><mi>η</mi><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">C_\ell(\eta)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">ℓ</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.03588em;">η</span><span class=mclose >)</span></span></span></span> is a normalization constant given by </p> <span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><msub><mi>C</mi><mi mathvariant=normal >ℓ</mi></msub><mo stretchy=false >(</mo><mi>η</mi><mo stretchy=false >)</mo><mo>=</mo><mfrac><mrow><msup><mn>2</mn><mi mathvariant=normal >ℓ</mi></msup><msup><mtext>e</mtext><mrow><mo>−</mo><mi>π</mi><mi>η</mi><mi mathvariant=normal >/</mi><mn>2</mn></mrow></msup><mi mathvariant=normal >∣</mi><mi mathvariant=normal >Γ</mi><mo stretchy=false >(</mo><mi mathvariant=normal >ℓ</mi><mo>+</mo><mn>1</mn><mo>+</mo><mi>i</mi><mi>η</mi><mo stretchy=false >)</mo><mi mathvariant=normal >∣</mi></mrow><mrow><mo stretchy=false >(</mo><mn>2</mn><mi mathvariant=normal >ℓ</mi><mo>+</mo><mn>1</mn><mo stretchy=false >)</mo><mo stretchy=false >!</mo></mrow></mfrac><mo separator=true >,</mo></mrow><annotation encoding="application/x-tex"> C_\ell(\eta) = \frac{2^\ell \text{e}^{-\pi\eta/2}|\Gamma(\ell+1+i\eta)|}{(2\ell+1)!}, </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">ℓ</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.03588em;">η</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2778em;"></span></span><span class=base ><span class=strut  style="height:2.501em;vertical-align:-0.936em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.565em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mopen >(</span><span class=mord >2</span><span class=mord >ℓ</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mord >1</span><span class=mclose >)!</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord ><span class=mord >2</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">ℓ</span></span></span></span></span></span></span></span><span class=mord ><span class="mord text"><span class=mord >e</span></span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.888em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">π</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">η</span><span class="mord mtight">/2</span></span></span></span></span></span></span></span></span><span class=mord >∣Γ</span><span class=mopen >(</span><span class=mord >ℓ</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mord >1</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222em;"></span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right:0.03588em;">η</span><span class=mclose >)</span><span class=mord >∣</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mpunct >,</span></span></span></span></span> <p>where <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant=normal >Γ</mi></mrow><annotation encoding="application/x-tex">\Gamma</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.6833em;"></span><span class=mord >Γ</span></span></span></span> is the gamma function. For numerical purposes, it is useful to use the <a href="https://dlmf.nist.gov/33.7">integral representation of the regular Coulomb wave function</a></p> <span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><msub><mi>F</mi><mi mathvariant=normal >ℓ</mi></msub><mo stretchy=false >(</mo><mi>η</mi><mo separator=true >,</mo><mi>ρ</mi><mo stretchy=false >)</mo><mo>=</mo><mfrac><mrow><msup><mi>ρ</mi><mrow><mi mathvariant=normal >ℓ</mi><mo>+</mo><mn>1</mn></mrow></msup><msup><mn>2</mn><mi mathvariant=normal >ℓ</mi></msup><msup><mi>e</mi><mrow><mi>i</mi><mi>ρ</mi><mo>−</mo><mo stretchy=false >(</mo><mi>π</mi><mi>η</mi><mi mathvariant=normal >/</mi><mn>2</mn><mo stretchy=false >)</mo></mrow></msup></mrow><mrow><mi mathvariant=normal >∣</mi><mi mathvariant=normal >Γ</mi><mo stretchy=false >(</mo><mi mathvariant=normal >ℓ</mi><mo>+</mo><mn>1</mn><mo>+</mo><mi>i</mi><mi>η</mi><mo stretchy=false >)</mo><mi mathvariant=normal >∣</mi></mrow></mfrac><msubsup><mo>∫</mo><mn>0</mn><mn>1</mn></msubsup><msup><mi>e</mi><mrow><mo>−</mo><mn>2</mn><mi>i</mi><mi>ρ</mi><mi>t</mi></mrow></msup><msup><mi>t</mi><mrow><mi mathvariant=normal >ℓ</mi><mo>+</mo><mi>i</mi><mi>η</mi></mrow></msup><mo stretchy=false >(</mo><mn>1</mn><mo>−</mo><mi>t</mi><msup><mo stretchy=false >)</mo><mrow><mi mathvariant=normal >ℓ</mi><mo>−</mo><mi>i</mi><mi>η</mi></mrow></msup><mtext> </mtext><mtext>d</mtext><mi>t</mi><mi mathvariant=normal >.</mi></mrow><annotation encoding="application/x-tex"> F_\ell(\eta,\rho) = \frac{\rho^{\ell+1}2^\ell e^{i\rho-(\pi\eta/2)}}{|\Gamma(\ell+1+i\eta)|} \int_0^1 e^{-2i\rho t}t^{\ell+i\eta}(1-t)^{\ell-i\eta} \, \text{d}t. </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">ℓ</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.03588em;">η</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.1667em;"></span><span class="mord mathnormal">ρ</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2778em;"></span></span><span class=base ><span class=strut  style="height:2.501em;vertical-align:-0.936em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.565em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >∣Γ</span><span class=mopen >(</span><span class=mord >ℓ</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mord >1</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222em;"></span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right:0.03588em;">η</span><span class=mclose >)</span><span class=mord >∣</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord ><span class="mord mathnormal">ρ</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">ℓ</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class=mord ><span class=mord >2</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">ℓ</span></span></span></span></span></span></span></span><span class=mord ><span class="mord mathnormal">e</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.888em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight">ρ</span><span class="mbin mtight">−</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">π</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">η</span><span class="mord mtight">/2</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mspace  style="margin-right:0.1667em;"></span><span class=mop ><span class="mop op-symbol large-op" style="margin-right:0.44445em;position:relative;top:-0.0011em;">∫</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.564em;"><span style="top:-1.7881em;margin-left:-0.4445em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span><span style="top:-3.8129em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.9119em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.1667em;"></span><span class=mord ><span class="mord mathnormal">e</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8747em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">2</span><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight">ρt</span></span></span></span></span></span></span></span></span><span class=mord ><span class="mord mathnormal">t</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8991em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">ℓ</span><span class="mbin mtight">+</span><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">η</span></span></span></span></span></span></span></span></span><span class=mopen >(</span><span class=mord >1</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222em;"></span></span><span class=base ><span class=strut  style="height:1.1491em;vertical-align:-0.25em;"></span><span class="mord mathnormal">t</span><span class=mclose ><span class=mclose >)</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8991em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">ℓ</span><span class="mbin mtight">−</span><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">η</span></span></span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.1667em;"></span><span class="mord text"><span class=mord >d</span></span><span class="mord mathnormal">t</span><span class=mord >.</span></span></span></span></span> <p>This implementation will need the gamma function from <a href="https://github.com/JuliaMath/SpecialFunctions.jl">SpecialFunctions.jl</a>. First we define complex integration</p> <pre><code class="julia hljs"><span class=hljs-keyword >using</span> QuadGK, SpecialFunctions, Plots

<span class=hljs-keyword >function</span> complex_quadrature(func,a,b)
    <span class=hljs-keyword >function</span> real_func(x)
        <span class=hljs-keyword >return</span> real(func(x))
    <span class=hljs-keyword >end</span>
    <span class=hljs-keyword >function</span> imag_func(x)
        imag(func(x))
    <span class=hljs-keyword >end</span>
    real_integral = quadgk(real_func,a,b)
    imag_integral = quadgk(imag_func,a,b)
    <span class=hljs-keyword >return</span> real_integral&lt;a href=<span class=hljs-string >&quot;https://en.wikipedia.org/wiki/Cauchy_principal_value&quot;</span>&gt;<span class=hljs-number >1</span>&lt;/a&gt; + <span class=hljs-number >1</span><span class=hljs-literal >im</span>*imag_integral&lt;a href=<span class=hljs-string >&quot;https://en.wikipedia.org/wiki/Cauchy_principal_value&quot;</span>&gt;<span class=hljs-number >1</span>&lt;/a&gt;
<span class=hljs-keyword >end</span></code></pre> <p>And we can now define the regular and irregular Coulomb wave functions</p> <pre><code class="julia hljs"><span class=hljs-keyword >function</span> regular_coulomb(ℓ,η,ρ)
    First = ρ^(ℓ+<span class=hljs-number >1</span>)*<span class=hljs-number >2</span>^ℓ*exp(<span class=hljs-number >1</span><span class=hljs-literal >im</span>*ρ-(<span class=hljs-literal >π</span>*η/<span class=hljs-number >2</span>))/(abs(gamma(ℓ+<span class=hljs-number >1</span>+<span class=hljs-number >1</span><span class=hljs-literal >im</span>*η)))
    Integral_value = complex_quadrature(t -&gt; exp(-<span class=hljs-number >2</span>*<span class=hljs-number >1</span><span class=hljs-literal >im</span>.*ρ*t)*t^(ℓ+<span class=hljs-number >1</span><span class=hljs-literal >im</span>*η)*(<span class=hljs-number >1</span>-t)^(ℓ-<span class=hljs-number >1</span><span class=hljs-literal >im</span>*η),<span class=hljs-number >0</span>,<span class=hljs-number >1</span>)
    <span class=hljs-keyword >return</span> First.*Integral_value
<span class=hljs-keyword >end</span>

<span class=hljs-keyword >function</span> C(ℓ,η)
    <span class=hljs-keyword >return</span> <span class=hljs-number >2</span>^ℓ*exp(-<span class=hljs-literal >π</span>*η/<span class=hljs-number >2</span>)*(abs(gamma(ℓ+<span class=hljs-number >1</span>+<span class=hljs-number >1</span><span class=hljs-literal >im</span>*η))/(factorial(<span class=hljs-number >2</span>*ℓ+<span class=hljs-number >1</span>)))
<span class=hljs-keyword >end</span>

<span class=hljs-keyword >function</span> irregular_coulomb(ℓ,η,ρ)
    First = exp(-<span class=hljs-number >1</span><span class=hljs-literal >im</span>*ρ)*ρ^(-ℓ)/(factorial(<span class=hljs-number >2</span>*ℓ+<span class=hljs-number >1</span>)*C(ℓ,η))
    Integral_value = complex_quadrature(t -&gt; exp(-t)*t^(-ℓ-<span class=hljs-number >1</span><span class=hljs-literal >im</span>*η)*(t+<span class=hljs-number >2</span>*<span class=hljs-number >1</span><span class=hljs-literal >im</span>*ρ)^(ℓ+<span class=hljs-number >1</span><span class=hljs-literal >im</span>*η),<span class=hljs-number >0.01</span>,<span class=hljs-number >1e4</span>)
    <span class=hljs-keyword >return</span> First.*Integral_value
<span class=hljs-keyword >end</span></code></pre> <h3 id=examples ><a href="#examples" class=header-anchor >Examples</a></h3> <p>To test the implementation consider the following examples</p> <pre><code class="julia hljs">x = range(<span class=hljs-number >0</span>,<span class=hljs-number >25</span>,<span class=hljs-number >1000</span>)
plot(x,regular_Coulomb.(<span class=hljs-number >0</span>,<span class=hljs-number >0.3</span>,x), label=<span class=hljs-string >L&quot;F_0(0.3,ρ)&quot;</span>)
plot!(x,regular_Coulomb.(<span class=hljs-number >0</span>,-<span class=hljs-number >0.3</span>,x), label=<span class=hljs-string >L&quot;F_0(-0.3,ρ)&quot;</span>)
xlabel!(<span class=hljs-string >L&quot;ρ&quot;</span>)
title!(<span class=hljs-string >&quot;Regular Coulomb Wave Functions&quot;</span>)</code></pre> <p>Which will show the following</p> <img src="/martinmikkelsen.github.io/pages/assets/menu1/output/Coulomb1.png" alt=""> <p>Use a similar approach to plot the regular Coulomb functions for different a <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant=normal >ℓ</mi></mrow><annotation encoding="application/x-tex">\ell</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.6944em;"></span><span class=mord >ℓ</span></span></span></span></p> <pre><code class="julia hljs">x = range(<span class=hljs-number >0</span>,<span class=hljs-number >25</span>,<span class=hljs-number >1000</span>)
plot(x,regular_Coulomb.(<span class=hljs-number >1e-5</span>,<span class=hljs-number >5</span>,x), label=<span class=hljs-string >L&quot;F_0(5,ρ)&quot;</span>)
plot!(x,regular_Coulomb.(<span class=hljs-number >1</span>,<span class=hljs-number >5</span>,x), label=<span class=hljs-string >L&quot;F_1(5,ρ)&quot;</span>)
plot!(x,regular_Coulomb.(<span class=hljs-number >2</span>,<span class=hljs-number >5</span>,x), label=<span class=hljs-string >L&quot;F_2(5,ρ)&quot;</span>)
plot!(x,regular_Coulomb.(<span class=hljs-number >3</span>,<span class=hljs-number >5</span>,x), label=<span class=hljs-string >L&quot;F_3(5,ρ)&quot;</span>)
title!(<span class=hljs-string >&quot;Regular Coulomb Wave Functions&quot;</span>)
xlabel!(<span class=hljs-string >L&quot;ρ&quot;</span>)</code></pre> <img src="/martinmikkelsen.github.io/pages/assets/menu1/output/Coulomb2.png" alt=""> <h2 id=solving_non-linear_partial_differential_equation_numerically_u_xxu_yymathrmeu ><a href="#solving_non-linear_partial_differential_equation_numerically_u_xxu_yymathrmeu" class=header-anchor >Solving non-linear partial differential equation numerically <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>u</mi><mrow><mi>x</mi><mi>x</mi></mrow></msub><mo>+</mo><msub><mi>u</mi><mrow><mi>y</mi><mi>y</mi></mrow></msub><mo>=</mo><msup><mi mathvariant=normal >e</mi><mi>u</mi></msup></mrow><annotation encoding="application/x-tex">u_{xx}+u_{yy}=\mathrm{e}^{u}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.7333em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal">u</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">xx</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222em;"></span></span><span class=base ><span class=strut  style="height:0.7167em;vertical-align:-0.2861em;"></span><span class=mord ><span class="mord mathnormal">u</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">yy</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.2861em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2778em;"></span></span><span class=base ><span class=strut  style="height:0.6644em;"></span><span class=mord ><span class="mord mathrm">e</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">u</span></span></span></span></span></span></span></span></span></span></span></span></a></h2> <p>This is a part of my answer on the <a href="https://scicomp.stackexchange.com/questions/43502/solving-non-linear-partial-differential-equation-numerically-u-xxu-yy-ma">Computational Science StackExchange</a> to the differential equation </p> <span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><msub><mi>u</mi><mrow><mi>x</mi><mi>x</mi></mrow></msub><mo>+</mo><msub><mi>u</mi><mrow><mi>y</mi><mi>y</mi></mrow></msub><mo>=</mo><msup><mi mathvariant=normal >e</mi><mi>u</mi></msup></mrow><annotation encoding="application/x-tex">u_{xx}+u_{yy}=\mathrm{e}^{u}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.7333em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal">u</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">xx</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222em;"></span></span><span class=base ><span class=strut  style="height:0.7167em;vertical-align:-0.2861em;"></span><span class=mord ><span class="mord mathnormal">u</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">yy</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.2861em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2778em;"></span></span><span class=base ><span class=strut  style="height:0.7144em;"></span><span class=mord ><span class="mord mathrm">e</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">u</span></span></span></span></span></span></span></span></span></span></span></span></span> <p>with the following boundary conditions:</p> <span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><mi>u</mi><mo stretchy=false >(</mo><mn>0</mn><mo separator=true >,</mo><mi>y</mi><mo stretchy=false >)</mo><mo>=</mo><mi>a</mi><mo separator=true >,</mo><mspace width=1em /><msub><mi>u</mi><mi>x</mi></msub><mo stretchy=false >(</mo><mn>0</mn><mo separator=true >,</mo><mi>y</mi><mo stretchy=false >)</mo><mo>=</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">u(0,y)=a, \quad u_x(0,y) = b</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">u</span><span class=mopen >(</span><span class=mord >0</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">a</span><span class=mpunct >,</span><span class=mspace  style="margin-right:1em;"></span><span class=mspace  style="margin-right:0.1667em;"></span><span class=mord ><span class="mord mathnormal">u</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mopen >(</span><span class=mord >0</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2778em;"></span></span><span class=base ><span class=strut  style="height:0.6944em;"></span><span class="mord mathnormal">b</span></span></span></span></span> <span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><mi>u</mi><mo stretchy=false >(</mo><mi>x</mi><mo separator=true >,</mo><mn>0</mn><mo stretchy=false >)</mo><mo>=</mo><mi>c</mi><mo separator=true >,</mo><mspace width=1em /><msub><mi>u</mi><mi>y</mi></msub><mo stretchy=false >(</mo><mi>x</mi><mo separator=true >,</mo><mn>0</mn><mo stretchy=false >)</mo><mo>=</mo><mi>d</mi></mrow><annotation encoding="application/x-tex">u(x,0)=c, \quad u_y(x,0) = d</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">u</span><span class=mopen >(</span><span class="mord mathnormal">x</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.1667em;"></span><span class=mord >0</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2778em;"></span></span><span class=base ><span class=strut  style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mord mathnormal">c</span><span class=mpunct >,</span><span class=mspace  style="margin-right:1em;"></span><span class=mspace  style="margin-right:0.1667em;"></span><span class=mord ><span class="mord mathnormal">u</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.2861em;"><span></span></span></span></span></span></span><span class=mopen >(</span><span class="mord mathnormal">x</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.1667em;"></span><span class=mord >0</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2778em;"></span></span><span class=base ><span class=strut  style="height:0.6944em;"></span><span class="mord mathnormal">d</span></span></span></span></span> <h3 id=solution ><a href="#solution" class=header-anchor >Solution </a></h3> <p>Use something like <a href="https://en.wikipedia.org/wiki/Cauchy_principal_value">MethodOfLines.jl</a> to solve your problem. Modify the following <a href="https://juliamath.github.io/QuadGK.jl/stable/quadgk-examples/#Cauchy-principal-values">example</a>, something like this </p> <pre><code class="julia hljs"><span class=hljs-keyword >using</span> ModelingToolkit, MethodOfLines, DomainSets, NonlinearSolve

<span class=hljs-meta >@parameters</span> x y
<span class=hljs-meta >@variables</span> u(..)

Dx = Differential(x)
Dy = Differential(y)
Dxx = Differential(x)^<span class=hljs-number >2</span>
Dyy = Differential(y)^<span class=hljs-number >2</span>

eq = Dxx(u(x, y)) + Dyy(u(x, y)) ~ exp(u(x,y))

a = <span class=hljs-number >5.2</span>
b = <span class=hljs-number >4.3</span>
c = <span class=hljs-number >3.5</span>
d = <span class=hljs-number >2.2</span>

bcs = [u(<span class=hljs-number >0</span>, y) ~ a,
       u(x, <span class=hljs-number >0</span>) ~ c,
       Dx(u(<span class=hljs-number >0</span>, y)) ~ b,
       Dy(u(x, <span class=hljs-number >0</span>)) ~ d]


domains = [x ∈ Interval(<span class=hljs-number >0.0</span>, <span class=hljs-number >1.0</span>),
           y ∈ Interval(<span class=hljs-number >0.0</span>, <span class=hljs-number >1.0</span>)]

<span class=hljs-meta >@named</span> pdesys = PDESystem([eq], bcs, domains, [x, y], [u(x, y)])

dx = <span class=hljs-number >0.1</span>
dy = <span class=hljs-number >0.1</span>

discretization = MOLFiniteDifference([x =&gt; dx, y =&gt; dy], <span class=hljs-literal >nothing</span>, approx_order=<span class=hljs-number >2</span>)

prob = discretize(pdesys, discretization)
sol = NonlinearSolve.solve(prob, NewtonRaphson())

u_sol = sol[u(x, y)]

<span class=hljs-keyword >using</span> Plots

heatmap(sol[x], sol[y], u_sol, xlabel=<span class=hljs-string >&quot;x&quot;</span>, ylabel=<span class=hljs-string >&quot;y&quot;</span>,
        title=<span class=hljs-string >&quot;Solution&quot;</span>)
		
savefig(joinpath(<span class=hljs-meta >@OUTPUT</span>, <span class=hljs-string >&quot;heat.png&quot;</span>))</code></pre> <p>Where I&#39;ve plugged in some random boundary conditions.</p> <img src="/martinmikkelsen.github.io/pages/assets/menu1/output/heat.png" alt=""> <p>Where the white space is due to the non-linearity of the differential equation. </p> <h2 id=optimal_quadrature_rule_for_heavy_tail_measure ><a href="#optimal_quadrature_rule_for_heavy_tail_measure" class=header-anchor >Optimal quadrature rule for heavy tail measure</a></h2> <p>This is my solution to the following <a href="https://scicomp.stackexchange.com/questions/43374/optimal-quadrature-rule-for-heavy-tail-measure/43377#43377">question</a>:</p> <p>I&#39;m looking for a well-thought quadrature rule for this measure <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>μ</mi><mo stretchy=false >(</mo><mi>t</mi><mo stretchy=false >)</mo><mo>=</mo><mfrac><mrow><mi>d</mi><mi>t</mi></mrow><msup><mi>t</mi><mi>s</mi></msup></mfrac></mrow><annotation encoding="application/x-tex">d\mu(t)=\frac{dt}{t^s}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">μ</span><span class=mopen >(</span><span class="mord mathnormal">t</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2778em;"></span></span><span class=base ><span class=strut  style="height:1.2251em;vertical-align:-0.345em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.8801em;"><span style="top:-2.655em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.5935em;"><span style="top:-2.786em;margin-right:0.0714em;"><span class=pstrut  style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">s</span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span> for <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mo>∈</mo><mo stretchy=false >(</mo><mn>0</mn><mo separator=true >,</mo><mn>1</mn><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">s\in(0,1)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">s</span><span class=mspace  style="margin-right:0.2778em;"></span><span class=mrel >∈</span><span class=mspace  style="margin-right:0.2778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mopen >(</span><span class=mord >0</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.1667em;"></span><span class=mord >1</span><span class=mclose >)</span></span></span></span>, the underlying motivation is to compute this integral</p> <span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><msup><mi>λ</mi><mrow><mi>s</mi><mo>−</mo><mn>1</mn></mrow></msup><mo>=</mo><mfrac><mn>1</mn><mrow><mi mathvariant=normal >Γ</mi><mo stretchy=false >(</mo><mn>1</mn><mo>−</mo><mi>s</mi><mo stretchy=false >)</mo></mrow></mfrac><msubsup><mo>∫</mo><mn>0</mn><mi mathvariant=normal >∞</mi></msubsup><msup><mi>e</mi><mrow><mo>−</mo><mi>t</mi><mi>λ</mi></mrow></msup><mfrac><mrow><mi>d</mi><mi>t</mi></mrow><msup><mi>t</mi><mi>s</mi></msup></mfrac></mrow><annotation encoding="application/x-tex"> \lambda^{s-1}=\frac{1}{\Gamma(1-s)}\int_{0}^{\infty} e^{-t\lambda}\frac{dt}{t^s} </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.8641em;"></span><span class=mord ><span class="mord mathnormal">λ</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2778em;"></span></span><span class=base ><span class=strut  style="height:2.3503em;vertical-align:-0.936em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.3214em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >Γ</span><span class=mopen >(</span><span class=mord >1</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222em;"></span><span class="mord mathnormal">s</span><span class=mclose >)</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >1</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mspace  style="margin-right:0.1667em;"></span><span class=mop ><span class="mop op-symbol large-op" style="margin-right:0.44445em;position:relative;top:-0.0011em;">∫</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.4143em;"><span style="top:-1.7881em;margin-left:-0.4445em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span><span style="top:-3.8129em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∞</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.9119em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.1667em;"></span><span class=mord ><span class="mord mathnormal">e</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8991em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.3714em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord ><span class="mord mathnormal">t</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.5904em;"><span style="top:-2.989em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal">d</span><span class="mord mathnormal">t</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span> <p>with <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\lambda &gt; 0</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.7335em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">λ</span><span class=mspace  style="margin-right:0.2778em;"></span><span class=mrel >&gt;</span><span class=mspace  style="margin-right:0.2778em;"></span></span><span class=base ><span class=strut  style="height:0.6444em;"></span><span class=mord >0</span></span></span></span>, see this reference, Page 5, equation &#40;5&#41;, https://arxiv.org/abs/1808.05159. So I&#39;m looking for a way of dealing with the singularity at <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">t=0</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.6151em;"></span><span class="mord mathnormal">t</span><span class=mspace  style="margin-right:0.2778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2778em;"></span></span><span class=base ><span class=strut  style="height:0.6444em;"></span><span class=mord >0</span></span></span></span> as well as the limit to <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant=normal >∞</mi></mrow><annotation encoding="application/x-tex">\infty</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.4306em;"></span><span class=mord >∞</span></span></span></span>. Observe that</p> <span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><msubsup><mo>∫</mo><mi>T</mi><mi mathvariant=normal >∞</mi></msubsup><mfrac><mrow><mi>d</mi><mi>t</mi></mrow><msup><mi>t</mi><mi>s</mi></msup></mfrac><mo>=</mo><mi mathvariant=normal >∞</mi></mrow><annotation encoding="application/x-tex"> \int_{T}^\infty \frac{dt}{t^s} = \infty </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:2.3262em;vertical-align:-0.9119em;"></span><span class=mop ><span class="mop op-symbol large-op" style="margin-right:0.44445em;position:relative;top:-0.0011em;">∫</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.4143em;"><span style="top:-1.7881em;margin-left:-0.4445em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span style="top:-3.8129em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">∞</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.9119em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.1667em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.3714em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord ><span class="mord mathnormal">t</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.5904em;"><span style="top:-2.989em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal">d</span><span class="mord mathnormal">t</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mspace  style="margin-right:0.2778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2778em;"></span></span><span class=base ><span class=strut  style="height:0.4306em;"></span><span class=mord >∞</span></span></span></span></span> <p>I was using the <code>QuadGK.jl</code> package and it is working just fine</p> <pre><code class="julia hljs">λ = <span class=hljs-number >2</span>; s = <span class=hljs-number >0.8</span>
λs = λ^(s-<span class=hljs-number >1</span>)

f(t) = exp(-λ*t)/t^s/gamma(<span class=hljs-number >1</span>-s)
res, err = quadgk(f,<span class=hljs-number >0</span>,<span class=hljs-literal >Inf</span>)</code></pre> <p>The predicted error and the real error is the same order of magnitude. However, when using the package for another formula</p> <span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><msup><mi>λ</mi><mi>s</mi></msup><mo>=</mo><mfrac><mn>1</mn><mrow><mi mathvariant=normal >Γ</mi><mo stretchy=false >(</mo><mo>−</mo><mi>s</mi><mo stretchy=false >)</mo></mrow></mfrac><msubsup><mo>∫</mo><mn>0</mn><mi mathvariant=normal >∞</mi></msubsup><mo stretchy=false >(</mo><msup><mi>e</mi><mrow><mo>−</mo><mi>t</mi><mi>λ</mi></mrow></msup><mo>−</mo><mn>1</mn><mo stretchy=false >)</mo><mfrac><mrow><mi>d</mi><mi>t</mi></mrow><msup><mi>t</mi><mrow><mn>1</mn><mo>+</mo><mi>s</mi></mrow></msup></mfrac></mrow><annotation encoding="application/x-tex"> \lambda^s = \frac{1}{\Gamma(-s)}\int_0^\infty (e^{-t\lambda}-1)\frac{dt}{t^{1+s}} </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.7144em;"></span><span class=mord ><span class="mord mathnormal">λ</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2778em;"></span></span><span class=base ><span class=strut  style="height:2.3503em;vertical-align:-0.936em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.3214em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >Γ</span><span class=mopen >(</span><span class=mord >−</span><span class="mord mathnormal">s</span><span class=mclose >)</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >1</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mspace  style="margin-right:0.1667em;"></span><span class=mop ><span class="mop op-symbol large-op" style="margin-right:0.44445em;position:relative;top:-0.0011em;">∫</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.4143em;"><span style="top:-1.7881em;margin-left:-0.4445em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span><span style="top:-3.8129em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">∞</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.9119em;"><span></span></span></span></span></span></span><span class=mopen >(</span><span class=mord ><span class="mord mathnormal">e</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8991em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222em;"></span></span><span class=base ><span class=strut  style="height:2.0574em;vertical-align:-0.686em;"></span><span class=mord >1</span><span class=mclose >)</span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.3714em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord ><span class="mord mathnormal">t</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.7401em;"><span style="top:-2.989em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mbin mtight">+</span><span class="mord mathnormal mtight">s</span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal">d</span><span class="mord mathnormal">t</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span> <p>same reference as before. I again do the quadrature</p> <pre><code class="julia hljs">λs = λ^s
g(t) = (exp(-λ*t)-<span class=hljs-number >1</span>)/t^(<span class=hljs-number >1</span>+s)/gamma(-s)
res, err = quadgk(g,<span class=hljs-number >0</span>,<span class=hljs-literal >Inf</span>)</code></pre> <p>it works just fine, but this time the real error is of order 1e-3 while the predicted error is around 1e-8. And if I put a positive matrix instead of a scalar</p> <pre><code class="julia hljs">A = <span class=hljs-comment ># some positive definite matrix</span>
h(t) = (exp(-A.*t)-I)/t^(<span class=hljs-number >1</span>+s)/gamma(-s)
res, err = quadgk(h,<span class=hljs-number >0</span>,<span class=hljs-literal >Inf</span>)</code></pre> <p>I get an ERROR: DomainError with 0.5: integrand produced NaN in the interval &#40;0.0, 1.0&#41;, and, to my understanding, quadgk does not evaluate the function at <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.6444em;"></span><span class=mord >0</span></span></span></span> as per the documentation https://juliamath.github.io/QuadGK.jl/stable/. And if I write</p> <pre><code class="julia hljs">res, err = quadgk(h,<span class=hljs-number >1e-50</span>,<span class=hljs-literal >Inf</span>)</code></pre>
<p>the integral blows up. </p>
<h3 id=solution__2 ><a href="#solution__2" class=header-anchor >Solution </a></h3>
<p>You can split the integral up such that you don&#39;t get the singularity at <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">t=0</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.6151em;"></span><span class="mord mathnormal">t</span><span class=mspace  style="margin-right:0.2778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2778em;"></span></span><span class=base ><span class=strut  style="height:0.6444em;"></span><span class=mord >0</span></span></span></span>. Something like this</p>
<pre><code class="julia hljs"><span class=hljs-keyword >using</span> QuadGK
<span class=hljs-keyword >using</span> SpecialFunctions 

λ = <span class=hljs-number >2.0</span>; s = <span class=hljs-number >0.8</span>
λs = λ^(s-<span class=hljs-number >1</span>)

f(t) = exp(-λ*t)/t^s/gamma(<span class=hljs-number >1</span>-s)
<span class=hljs-meta >@show</span> res, err = quadgk(f,<span class=hljs-number >0</span>,<span class=hljs-literal >Inf</span>)

λs = λ^s
g(t) = (exp(-λ*t)-<span class=hljs-number >1</span>)/t^(<span class=hljs-number >1</span>+s)/gamma(-s)
<span class=hljs-meta >@show</span> res, err = quadgk(g,<span class=hljs-number >0</span>,<span class=hljs-literal >Inf</span>)

A = [<span class=hljs-number >2</span> -<span class=hljs-number >1</span> <span class=hljs-number >0</span>; -<span class=hljs-number >1</span> <span class=hljs-number >2</span> -<span class=hljs-number >1</span>; <span class=hljs-number >0</span> -<span class=hljs-number >1</span> <span class=hljs-number >2</span>] <span class=hljs-comment ># some positive definite matrix</span>
h(t) = (exp(-A.*t)-I)/t^(<span class=hljs-number >1</span>+s)/gamma(-s)

singularity_integral, singularity_error = quadgk(h, <span class=hljs-number >1e-10</span>, <span class=hljs-number >1e-5</span>)
regular_integral, regular_error = quadgk(h, <span class=hljs-number >1e-5</span>, <span class=hljs-literal >Inf</span>)
<span class=hljs-meta >@show</span> result = singularity_integral + regular_integral
<span class=hljs-meta >@show</span> error = singularity_error + regular_error</code></pre>
<p>which will print</p>
<pre><code class="julia hljs">(res, err) = quadgk(f, <span class=hljs-number >0</span>, <span class=hljs-literal >Inf</span>) = (<span class=hljs-number >0.8705505365052336</span>, <span class=hljs-number >1.2164780075652479e-8</span>)
(res, err) = quadgk(g, <span class=hljs-number >0</span>, <span class=hljs-literal >Inf</span>) = (<span class=hljs-number >1.7402976255082268</span>, <span class=hljs-number >2.515036776166618e-8</span>)
result = singularity_integral + regular_integral = [<span class=hljs-number >1.6837899364901885</span> -<span class=hljs-number >0.7050512093960599</span> -<span class=hljs-number >0.03988519645256732</span>; -<span class=hljs-number >0.7050512093960599</span> <span class=hljs-number >1.6439047399317526</span> -<span class=hljs-number >0.7050512098966073</span>; -<span class=hljs-number >0.03988519645256732</span> -<span class=hljs-number >0.7050512098966073</span> <span class=hljs-number >1.683789936502625</span>]
error = singularity_error + regular_error = <span class=hljs-number >3.822238569033589e-8</span></code></pre>
<p>Alternatively, you can also look into something like <a href="https://en.wikipedia.org/wiki/Cauchy_principal_value">Cauchy principal values</a> and <a href="https://juliamath.github.io/QuadGK.jl/stable/quadgk-examples/#Cauchy-principal-values">this example</a></p>
<p>–Edit: update to new information–</p>
<p>I&#39;m afraid I can&#39;t reproduce the same error. When I run your code &#40;I&#39;ve added using LinearAlgebra for <a href="https://docs.julialang.org/en/v1/stdlib/LinearAlgebra/#LinearAlgebra.diagm">diagm</a>&#41; I get </p>
<pre><code class="julia hljs">res2 = [<span class=hljs-number >15.354655632950173</span> -<span class=hljs-number >6.419790221101635</span> -<span class=hljs-number >0.3665284746983265</span>; -<span class=hljs-number >6.419790221101635</span> <span class=hljs-number >14.988127158828647</span> -<span class=hljs-number >6.4197902215468154</span>; -<span class=hljs-number >0.3665284746983265</span> -<span class=hljs-number >6.4197902215468154</span> <span class=hljs-number >15.354655632887033</span>]
norm(res2 + As) / norm(As) = <span class=hljs-number >0.018647374162762107</span>
norm(res1 + As) / norm(As) = <span class=hljs-number >0.01864737561229984</span>
norm(res1 - res2) = <span class=hljs-number >4.9872522079524005e-8</span>
<span class=hljs-number >4.9872522079524005e-8</span></code></pre>
<p>  </p>
<div class=page-foot >
    <a href="http://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA 4.0</a> Martin Mikkelsen. Last modified: November 28, 2023.
    Website built with <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a> and the <a href="https://julialang.org">Julia programming language</a>.
</div>
</div>
    
        



    
    
        <script src="/martinmikkelsen.github.io/pages/libs/highlight/highlight.min.js"></script>
<script>hljs.highlightAll();hljs.configure({tabReplace: '    '});</script>